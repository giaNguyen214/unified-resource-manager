apiVersion: batch/v1
kind: Job
metadata:
  name: mpioperator-openmpi-latest-demo1

spec:

  template:
    spec:
      restartPolicy: Never



      schedulerName: yunikorn



      volumes:
      - name: code
        hostPath:
          path: /mnt/jobs/code
          type: Directory
      - name: env
        emptyDir: {}

      initContainers:
      - name: env-builder
        image: ubuntu:22.04
        command: ["/bin/bash","-c"]
        args:
          - |
            apt update && apt install -y python3 python3-pip git cmake build-essential wget curl  openmpi-bin  libssl-dev  build-essential  cmake  git  wget  curl 

            pip3 install  tensorflow  torch  xgboost  scikit-learn  ray  dask 


            git clone https://github.com/dmlc/xgboost.git /tmp/src
            cd /tmp/src

            mkdir build

            cd build

            cmake ..

            make -j4

            make install



            cp -r /usr/local/* /env/ || true

        volumeMounts:
        - name: env
          mountPath: /env



      containers:
      - name: mpioperator-openmpi-latest
        image: mpioperator/openmpi:latest


        command: ["python3","/code/main.py"]
        volumeMounts:
        - name: code
          mountPath: /code
        - name: env
          mountPath: /usr/local



        resources:
          requests:
            cpu: "4"
            memory: "8Gi"

            nvidia.com/gpu: 1

          limits:
            cpu: "4"
            memory: "8Gi"

            nvidia.com/gpu: 1


---
apiVersion: batch/v1
kind: Job
metadata:
  name: bitnami-spark-3.5-demo1

spec:

  template:
    spec:
      restartPolicy: Never



      schedulerName: yunikorn




      containers:
      - name: bitnami-spark-3.5
        image: bitnami/spark:3.5




        resources:
          requests:
            cpu: "4"
            memory: "8Gi"
          limits:
            cpu: "4"
            memory: "8Gi"

---
apiVersion: batch/v1
kind: Job
metadata:
  name: flink-1.18-demo1

spec:

  template:
    spec:
      restartPolicy: Never



      schedulerName: yunikorn




      containers:
      - name: flink-1.18
        image: flink:1.18




        resources:
          requests:
            cpu: "4"
            memory: "8Gi"
          limits:
            cpu: "4"
            memory: "8Gi"

---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: bitnami-kafka-latest-demo1

spec:

  serviceName: bitnami-kafka-latest-demo1
  selector:
    matchLabels:
      app: bitnami-kafka-latest-demo1
  template:
    metadata:
      labels:
        app: bitnami-kafka-latest-demo1
    spec:



      schedulerName: yunikorn




      containers:
      - name: bitnami-kafka-latest
        image: bitnami/kafka:latest




        resources:
          requests:
            cpu: "4"
            memory: "8Gi"
          limits:
            cpu: "4"
            memory: "8Gi"

---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: bitnami-hadoop-latest-demo1

spec:

  serviceName: bitnami-hadoop-latest-demo1
  selector:
    matchLabels:
      app: bitnami-hadoop-latest-demo1
  template:
    metadata:
      labels:
        app: bitnami-hadoop-latest-demo1
    spec:



      schedulerName: yunikorn




      containers:
      - name: bitnami-hadoop-latest
        image: bitnami/hadoop:latest




        resources:
          requests:
            cpu: "4"
            memory: "8Gi"
          limits:
            cpu: "4"
            memory: "8Gi"

---
apiVersion: batch/v1
kind: Job
metadata:
  name: tensorflow-tensorflow-2.15.0-gpu-demo1

spec:

  template:
    spec:
      restartPolicy: Never



      schedulerName: yunikorn



      volumes:
      - name: code
        hostPath:
          path: /mnt/jobs/code
          type: Directory
      - name: env
        emptyDir: {}

      initContainers:
      - name: env-builder
        image: ubuntu:22.04
        command: ["/bin/bash","-c"]
        args:
          - |
            apt update && apt install -y python3 python3-pip git cmake build-essential wget curl  openmpi-bin  libssl-dev  build-essential  cmake  git  wget  curl 

            pip3 install  tensorflow  torch  xgboost  scikit-learn  ray  dask 


            git clone https://github.com/dmlc/xgboost.git /tmp/src
            cd /tmp/src

            mkdir build

            cd build

            cmake ..

            make -j4

            make install



            cp -r /usr/local/* /env/ || true

        volumeMounts:
        - name: env
          mountPath: /env



      containers:
      - name: tensorflow-tensorflow-2.15.0-gpu
        image: tensorflow/tensorflow:2.15.0-gpu


        command: ["python3","/code/main.py"]
        volumeMounts:
        - name: code
          mountPath: /code
        - name: env
          mountPath: /usr/local



        resources:
          requests:
            cpu: "4"
            memory: "8Gi"

            nvidia.com/gpu: 1

          limits:
            cpu: "4"
            memory: "8Gi"

            nvidia.com/gpu: 1


---
apiVersion: batch/v1
kind: Job
metadata:
  name: pytorch-pytorch-2.1.0-cuda11.8-cudnn8-runtime-demo1

spec:

  template:
    spec:
      restartPolicy: Never



      schedulerName: yunikorn



      volumes:
      - name: code
        hostPath:
          path: /mnt/jobs/code
          type: Directory
      - name: env
        emptyDir: {}

      initContainers:
      - name: env-builder
        image: ubuntu:22.04
        command: ["/bin/bash","-c"]
        args:
          - |
            apt update && apt install -y python3 python3-pip git cmake build-essential wget curl  openmpi-bin  libssl-dev  build-essential  cmake  git  wget  curl 

            pip3 install  tensorflow  torch  xgboost  scikit-learn  ray  dask 


            git clone https://github.com/dmlc/xgboost.git /tmp/src
            cd /tmp/src

            mkdir build

            cd build

            cmake ..

            make -j4

            make install



            cp -r /usr/local/* /env/ || true

        volumeMounts:
        - name: env
          mountPath: /env



      containers:
      - name: pytorch-pytorch-2.1.0-cuda11.8-cudnn8-runtime
        image: pytorch/pytorch:2.1.0-cuda11.8-cudnn8-runtime


        command: ["python3","/code/main.py"]
        volumeMounts:
        - name: code
          mountPath: /code
        - name: env
          mountPath: /usr/local



        resources:
          requests:
            cpu: "4"
            memory: "8Gi"

            nvidia.com/gpu: 1

          limits:
            cpu: "4"
            memory: "8Gi"

            nvidia.com/gpu: 1


---
apiVersion: batch/v1
kind: Job
metadata:
  name: dmlc-xgboost-latest-demo1

spec:

  template:
    spec:
      restartPolicy: Never



      schedulerName: yunikorn



      volumes:
      - name: code
        hostPath:
          path: /mnt/jobs/code
          type: Directory
      - name: env
        emptyDir: {}

      initContainers:
      - name: env-builder
        image: ubuntu:22.04
        command: ["/bin/bash","-c"]
        args:
          - |
            apt update && apt install -y python3 python3-pip git cmake build-essential wget curl  openmpi-bin  libssl-dev  build-essential  cmake  git  wget  curl 

            pip3 install  tensorflow  torch  xgboost  scikit-learn  ray  dask 


            git clone https://github.com/dmlc/xgboost.git /tmp/src
            cd /tmp/src

            mkdir build

            cd build

            cmake ..

            make -j4

            make install



            cp -r /usr/local/* /env/ || true

        volumeMounts:
        - name: env
          mountPath: /env



      containers:
      - name: dmlc-xgboost-latest
        image: dmlc/xgboost:latest


        command: ["python3","/code/main.py"]
        volumeMounts:
        - name: code
          mountPath: /code
        - name: env
          mountPath: /usr/local



        resources:
          requests:
            cpu: "4"
            memory: "8Gi"

            nvidia.com/gpu: 1

          limits:
            cpu: "4"
            memory: "8Gi"

            nvidia.com/gpu: 1


---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: redis-7-demo1

spec:

  serviceName: redis-7-demo1
  selector:
    matchLabels:
      app: redis-7-demo1
  template:
    metadata:
      labels:
        app: redis-7-demo1
    spec:



      schedulerName: yunikorn




      containers:
      - name: redis-7
        image: redis:7




        resources:
          requests:
            cpu: "4"
            memory: "8Gi"
          limits:
            cpu: "4"
            memory: "8Gi"

---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: postgres-16-demo1

spec:

  serviceName: postgres-16-demo1
  selector:
    matchLabels:
      app: postgres-16-demo1
  template:
    metadata:
      labels:
        app: postgres-16-demo1
    spec:



      schedulerName: yunikorn




      containers:
      - name: postgres-16
        image: postgres:16




        resources:
          requests:
            cpu: "4"
            memory: "8Gi"
          limits:
            cpu: "4"
            memory: "8Gi"
